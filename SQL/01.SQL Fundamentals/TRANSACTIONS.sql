USE ComplexFoodDB;

BEGIN TRY
	BEGIN TRANSACTION
		UPDATE Buyers
		SET Firstname = 'Alin'
		WHERE Firstname = 'Stefan';

		UPDATE Buyers
		SET Confirmed = 1
		WHERE Confirmed = 0;

		UPDATE Coupons
		SET UniqueCode = '9999999999999999999999'
		WHERE ID = 1;
	COMMIT TRANSACTION
END TRY

BEGIN CATCH
	ROLLBACK TRANSACTION
END CATCH


BEGIN TRY
	BEGIN TRANSACTION
		DELETE FROM Buyers
		WHERE ID = 1;

		DELETE FROM Buyers
		WHERE Confirmed = 0;

		DELETE Coupons
		WHERE ID = 111;

	COMMIT TRANSACTION
END TRY

BEGIN CATCH
	ROLLBACK TRANSACTION
END CATCH